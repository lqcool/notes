## 工厂方法模式

### 工厂方法模式定义

> 工厂方法模式又**称之为工厂模式，也叫虚拟构造器模式或者多态工厂模式**，属于创建型模式。
>
> 工厂方法模式中，工厂父类负责定义创建产品对象的公共接口，而工厂子类负责完成生成具体的对象，目的是**将类的实例化延迟到了工厂子类中完成** 。

### 模式结构与分析

> 模式结构图：
>
> ![17](https://github.com/lqcool/notes/blob/master/%E4%BB%93%E5%BA%93%E5%9B%BE%E5%BA%93/17.png)
>
> 模式分析：
>
> 工厂模式是简单工厂模式的进一步抽象和推广，由于**使用了面向对象的多态性**，保持了简单工厂模式的优点（对象的创建和使用分离），又克服了它的缺点。该模式中对象的创建不再由核心工厂类完成，而是有其子类完成。
>
> 工厂模式和简单工厂模式结构上面明显的区别是，简单工厂模式把核心放在一个具体类，而工厂模式的核心是一个抽象类。
>
> 很好的符合开闭原则：当需要添加一个新的产品时，只需要在原有的基础上面添加一个具体产品对象以及一个具体工厂对象，不需要修改原有代码。
>
> 例子：工厂模式之电视机工厂：
>
> ![18](https://github.com/lqcool/notes/blob/master/%E4%BB%93%E5%BA%93%E5%9B%BE%E5%BA%93/18.png)

### 工厂模式的优缺点

> 工厂方法模式优点：
>
> - 工厂方法模式中，工厂方法用来创建客户所需要的产品，同时还向客户隐藏了哪中具体的产品被实例化这一过程，用户只需关心所需产品对应的工厂，无需关心创建细节，甚至无需知道产品的具体类名。
> - **基于工厂角色和产品角色的多态性设计是工厂方法模式的关键** 。它能够使得工厂可以自主确定创建何种产品对象，而不和创建这个对象的细节完全封装在了工厂内部。**工厂方法模式之所以被称之为多态工厂模式，是因为所有的具体工厂类都具有同一抽象的父类** 。
> - 在系统新加入产品的时候，无需修改抽象工厂和抽象产品提供的接口或者其它原有代码的修改，只需要添加一个工厂一个产品就可以了。
>
> 工厂方法模式缺点：
>
> - 添加新产品，需要编写具体的产品类，而且还要提供与之对应的具体工厂类，系统类的数量增加了，编译的类增多，增加系统的开销。
> - 考虑到可扩展性，引入了抽象层，可能使用到DOM、反射等技术，增加系统的实现难度。

### 模式适用环境

> - **一个类不知道她所需要的对象的类**，例如客户端不需要知道具体的类名称，只需要知道对应的工厂即可。
> - **一个类通过其子类指定创建的哪个对象**，工厂方法模式中，抽象工厂提供接口，子类决定需要创建的对象，利用多态性和里氏替换原则，程序运行时，子类对象将覆盖父类对象，使得系统更加容易扩展。
> - **将创建对象的任务委托给多个工厂子类中的某一个**，客户端使用时无需关心哪一个工厂类创建了产品子类，需要时再动态指定，可以将工厂类名称放在配置文件中或者数据库中。

